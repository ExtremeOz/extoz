{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "TenantConfig",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "configVersion",
    "id",
    "name",
    "assets",
    "cssVars",
    "text",
    "endpoints",
    "services"
  ],
  "properties": {
    "configVersion": {
      "type": "integer",
      "minimum": 1,
      "description": "Schema version for future migration support"
    },
    "id": {
      "type": "string",
      "pattern": "^[a-z0-9-]{2,40}$",
      "description": "Stable, lowercase key used in URLs and allowlists"
    },
    "name": {
      "type": "string",
      "minLength": 1
    },
    "assets": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "logo",
        "favicon"
      ],
      "properties": {
        "logo": {
          "type": "string",
          "format": "uri-reference"
        },
        "favicon": {
          "type": "string",
          "format": "uri-reference"
        },
        "hero": {
          "type": "string",
          "format": "uri-reference"
        }
      }
    },
    "cssVars": {
      "type": "object",
      "description": "CSS variables applied to :root (e.g., --brand, --accent)",
      "patternProperties": {
        "^[a-zA-Z0-9-]+$": {
          "type": "string"
        }
      },
      "additionalProperties": false
    },
    "text": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "title": {
          "type": "object",
          "patternProperties": {
            "^[a-z]{2}(-[A-Z]{2})?$": {
              "type": "string"
            }
          },
          "additionalProperties": false
        },
        "displayName": {
          "type": "object",
          "patternProperties": {
            "^[a-z]{2}(-[A-Z]{2})?$": {
              "type": "string"
            }
          },
          "additionalProperties": false
        },
        "tagline": {
          "type": "object",
          "patternProperties": {
            "^[a-z]{2}(-[A-Z]{2})?$": {
              "type": "string"
            }
          },
          "additionalProperties": false
        },
        "tagline2": {
          "type": "object",
          "patternProperties": {
            "^[a-z]{2}(-[A-Z]{2})?$": {
              "type": "string"
            }
          },
          "additionalProperties": false
        },
        "cta": {
          "type": "object",
          "patternProperties": {
            "^[a-z]{2}(-[A-Z]{2})?$": {
              "type": "string"
            }
          },
          "additionalProperties": false
        }
      }
    },
    "services": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": [
          "id",
          "label"
        ],
        "properties": {
          "id": {
            "type": "string",
            "pattern": "^[a-z0-9-]{2,40}$"
          },
          "label": {
            "type": "string",
            "minLength": 1
          }
        }
      }
    },
    "features": {
      "type": "object",
      "additionalProperties": {
        "type": "boolean"
      },
      "properties": {
        "enablePhoneVerification": {
          "type": "boolean",
          "default": true
        },
        "enableEmailVerification": {
          "type": "boolean",
          "default": true
        },
        "showSupportChat": {
          "type": "boolean",
          "default": false
        }
      }
    },
    "policy": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "allowedOrigins": {
          "type": "array",
          "minItems": 1,
          "items": {
            "type": "string",
            "format": "uri",
            "pattern": "^https://"
          }
        },
        "supportEmail": {
          "type": "string",
          "format": "email"
        },
        "privacyUrl": {
          "type": "string",
          "format": "uri"
        },
        "termsUrl": {
          "type": "string",
          "format": "uri"
        }
      }
    },
    "endpoints": {
      "type": "object",
      "additionalProperties": false,
      "minProperties": 1,
      "properties": {
        "verifyHttpFlow": {
          "type": "string",
          "format": "uri"
        },
        "auditDataverse": {
          "type": "string",
          "format": "uri"
        }
      }
    }
  },
  "allOf": [
    {
      "if": {
        "properties": {
          "features": {
            "properties": {
              "enablePhoneVerification": {
                "const": true
              }
            }
          }
        }
      },
      "then": {
        "properties": {
          "endpoints": {
            "required": [
              "verifyHttpFlow"
            ]
          }
        }
      }
    }
  ]
}